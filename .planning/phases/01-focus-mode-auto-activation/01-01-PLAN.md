---
phase: 01-focus-mode-auto-activation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/types/index.ts
  - src/app/page.tsx
  - src/components/SettingsModal.tsx
autonomous: true

must_haves:
  truths:
    - "Focus mode activates automatically when user clicks play"
    - "Focus mode exits when user pauses or reading completes"
    - "Focus mode setting no longer exists in settings modal"
    - "Focus mode state is not persisted to localStorage"
  artifacts:
    - path: "src/types/index.ts"
      provides: "RSVPSettings interface without focusModeEnabled"
      contains: "RSVPSettings"
    - path: "src/app/page.tsx"
      provides: "Focus mode derived from isPlaying && !isComplete"
      contains: "isFocusMode = isPlaying && !isComplete"
    - path: "src/components/SettingsModal.tsx"
      provides: "Settings modal without focus mode toggle"
  key_links:
    - from: "src/app/page.tsx"
      to: "useRSVP hook"
      via: "isPlaying and isComplete destructured"
      pattern: "isPlaying.*isComplete"
---

<objective>
Remove focus mode toggle setting and implement auto-activation based on playback state.

Purpose: Simplify UX by automatically entering focus mode when reading starts and exiting when paused or complete, eliminating manual toggle.
Output: Focus mode behavior tied to isPlaying && !isComplete, settings cleaned up.
</objective>

<execution_context>
@/Users/haokunyang/.claude/get-shit-done/workflows/execute-plan.md
@/Users/haokunyang/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-focus-mode-auto-activation/01-CONTEXT.md
@.planning/phases/01-focus-mode-auto-activation/01-RESEARCH.md
@src/types/index.ts
@src/app/page.tsx
@src/components/SettingsModal.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove focusModeEnabled from settings type</name>
  <files>src/types/index.ts</files>
  <action>
    Remove `focusModeEnabled: boolean` from the RSVPSettings interface (line 41).
    Remove `focusModeEnabled: false` from DEFAULT_SETTINGS object (line 48).

    This ensures focus mode state is never persisted to localStorage since it's now purely derived from playback state.
  </action>
  <verify>TypeScript compiles without errors: `npx tsc --noEmit`</verify>
  <done>RSVPSettings interface no longer includes focusModeEnabled field</done>
</task>

<task type="auto">
  <name>Task 2: Update focus mode logic in page.tsx</name>
  <files>src/app/page.tsx</files>
  <action>
    Change line 126 from:
    `const isFocusMode = isPlaying && settings.focusModeEnabled;`

    To:
    `const isFocusMode = isPlaying && !isComplete;`

    This ties focus mode directly to playback state:
    - Enters focus mode when playing starts
    - Exits when paused (isPlaying becomes false)
    - Exits when reading completes (isComplete becomes true)

    Also add `motion-reduce:transition-none` to all transition classes for accessibility:
    - Line 133: Add `motion-reduce:transition-none` after `transition-opacity duration-300`
    - Line 200: Add `motion-reduce:transition-none` after `transition-all duration-300`
    - Line 225: Add `motion-reduce:transition-none` after `transition-opacity duration-300`

    Remove the focus mode exit hint (lines 214-219) - per CONTEXT.md: "No exit hints — trust user knows to click/press space"
  </action>
  <verify>
    1. Run `npx tsc --noEmit` - no type errors
    2. Run `npm run dev` and verify:
       - Click play: UI fades out, reader display expands
       - Press space: reading pauses, UI returns
       - Let reading complete: UI returns automatically
  </verify>
  <done>Focus mode auto-activates on play, exits on pause/complete, respects reduced motion preference</done>
</task>

<task type="auto">
  <name>Task 3: Remove focus mode toggle from SettingsModal</name>
  <files>src/components/SettingsModal.tsx</files>
  <action>
    Remove the entire Focus Mode toggle section (lines 78-93):
    ```
    {/* Focus Mode */}
    <div className="flex items-center justify-between">
      <label className="text-sm font-medium">Focus Mode</label>
      <button
        onClick={() => onUpdate({ focusModeEnabled: !settings.focusModeEnabled })}
        ...
      </button>
    </div>
    ```

    This removes user control over focus mode since it's now automatic.
  </action>
  <verify>
    1. Run `npx tsc --noEmit` - no type errors
    2. Run `npm run dev`, open settings modal - no focus mode toggle visible
  </verify>
  <done>Settings modal no longer shows focus mode toggle option</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with no errors
2. `npm run dev` runs successfully
3. Manual test flow:
   - Paste text, click play → focus mode activates (UI hides)
   - Press space → focus mode exits (UI returns)
   - Click play again, let reading complete → focus mode exits automatically
   - Open settings → no focus mode toggle present
4. Refresh page → focus mode does not persist (starts in normal UI)
</verification>

<success_criteria>
- Focus mode is purely derived from isPlaying && !isComplete
- No focusModeEnabled in types/settings
- Settings modal has no focus mode toggle
- Reduced motion users see instant transitions (no animation)
- No exit hint shown in focus mode
</success_criteria>

<output>
After completion, create `.planning/phases/01-focus-mode-auto-activation/01-01-SUMMARY.md`
</output>
